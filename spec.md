# Discord IP æ©Ÿå™¨äººå°ˆæ¡ˆè¦æ ¼æ–‡ä»¶

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

### å°ˆæ¡ˆåç¨±
Discord IP Bot - è‡ªå‹•åŒ–IPåœ°å€ç›£æ§èˆ‡é€šçŸ¥æ©Ÿå™¨äºº

### å°ˆæ¡ˆæè¿°
é€™æ˜¯ä¸€å€‹è‡ªå‹•åŒ–çš„Discordæ©Ÿå™¨äººç³»çµ±ï¼Œé€éæœ¬åœ°è…³æœ¬æ¯æ—¥å®šæ™‚æª¢æŸ¥æœ¬æ©ŸIPåœ°å€ï¼Œä¸¦å°‡IPè³‡è¨Šç™¼é€åˆ°æŒ‡å®šçš„Discordä¼ºæœå™¨é »é“ã€‚ç³»çµ±è¨­è¨ˆç‚ºè¼•é‡ç´šã€é«˜å¯é æ€§çš„ç›£æ§è§£æ±ºæ–¹æ¡ˆã€‚

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ” è‡ªå‹•æª¢æ¸¬æœ¬æ©ŸIPåœ°å€ï¼ˆå…§ç¶²IPèˆ‡å¤–ç¶²IPï¼‰
- ğŸ“… æ¯æ—¥å®šæ™‚è‡ªå‹•åŸ·è¡Œ
- ğŸ¯ **æ™ºèƒ½è®ŠåŒ–æª¢æ¸¬**ï¼šåªæœ‰IPè®ŠåŒ–æ™‚æ‰ç™¼é€é€šçŸ¥ï¼ˆæ’ç¨‹æ¨¡å¼ï¼‰
- ğŸ“± **æ‰‹å‹•åŸ·è¡Œæ¨¡å¼**ï¼šç«‹å³æª¢æ¸¬ä¸¦ç™¼é€é€šçŸ¥ï¼ˆç„¡è«–IPæ˜¯å¦è®ŠåŒ–ï¼‰
- ğŸ’¾ **IPæ­·å²ç®¡ç†**ï¼šæŒä¹…åŒ–è¨˜éŒ„IPè®ŠåŒ–æ­·å²èˆ‡çµ±è¨ˆè³‡è¨Š
- ğŸ’¬ ç™¼é€æ ¼å¼åŒ–è¨Šæ¯åˆ°Discordé »é“
- ğŸ“ å®Œæ•´çš„æ—¥èªŒè¨˜éŒ„èˆ‡éŒ¯èª¤è™•ç†
- ğŸ”’ å®‰å…¨çš„è¨­å®šæª”ç®¡ç†
- ğŸ–¥ï¸ è·¨å¹³å°æ”¯æ´ï¼ˆWindowsã€Linuxã€macOSï¼‰

## âœ… æŠ€è¡“å¯è¡Œæ€§è©•ä¼°

### æ•´é«”è©•ä¼°ï¼šå®Œå…¨å¯è¡Œ â­â­â­â­â­

| æŠ€è¡“é ˜åŸŸ | å¯è¡Œæ€§ | é›£åº¦ç­‰ç´š | é¢¨éšªè©•ä¼° |
|---------|--------|----------|----------|
| IPåœ°å€æª¢æ¸¬ | âœ… å®Œå…¨å¯è¡Œ | ç°¡å–® | ä½é¢¨éšª |
| Discord APIé€šä¿¡ | âœ… å®Œå…¨å¯è¡Œ | ç°¡å–® | ä½é¢¨éšª |
| æ’ç¨‹ç³»çµ± | âœ… å®Œå…¨å¯è¡Œ | ç°¡å–® | ä½é¢¨éšª |
| è·¨å¹³å°éƒ¨ç½² | âœ… å®Œå…¨å¯è¡Œ | ä¸­ç­‰ | ä¸­é¢¨éšª |
| éŒ¯èª¤è™•ç† | âœ… å®Œå…¨å¯è¡Œ | ä¸­ç­‰ | ä½é¢¨éšª |

### æŠ€è¡“å„ªå‹¢
- Pythonç”Ÿæ…‹ç³»çµ±æˆç†Ÿï¼Œæœ‰è±å¯Œçš„ç›¸é—œåº«
- Discord APIç©©å®šä¸”æ–‡ä»¶å®Œå–„
- IPæª¢æ¸¬æŠ€è¡“æˆç†Ÿå¯é 
- æ’ç¨‹æŠ€è¡“åœ¨å„å¹³å°éƒ½æœ‰åŸç”Ÿæ”¯æ´

### æ½›åœ¨æŒ‘æˆ°èˆ‡è§£æ±ºæ–¹æ¡ˆ
1. **ç¶²è·¯é€£ç·šç©©å®šæ€§** â†’ å¯¦ç¾é‡è©¦æ©Ÿåˆ¶èˆ‡é›¢ç·šè™•ç†
2. **Discord APIé€Ÿç‡é™åˆ¶** â†’ åˆç†æ§åˆ¶è«‹æ±‚é »ç‡
3. **æ¬Šé™è¨­å®šè¤‡é›œæ€§** â†’ æä¾›è©³ç´°è¨­å®šæŒ‡å—
4. **è·¨å¹³å°å·®ç•°** â†’ ä½¿ç”¨è·¨å¹³å°åº«å’Œæ¨™æº–åŒ–é…ç½®

## ğŸ¯ ä»»å‹™åˆ†è§£èˆ‡é–‹ç™¼éšæ®µ

### ç¬¬ä¸€éšæ®µï¼šå°ˆæ¡ˆåŸºç¤å»ºè¨­
- [x] **ä»»å‹™1.1**: å°ˆæ¡ˆç›®éŒ„çµæ§‹å»ºç«‹ âœ… **å·²å®Œæˆ**
- [x] **ä»»å‹™1.2**: åŸºç¤é…ç½®æ–‡ä»¶å‰µå»º âœ… **å·²å®Œæˆ**
- [x] **ä»»å‹™1.3**: ä¾è³´ç®¡ç†è¨­å®š âœ… **å·²å®Œæˆ**
- [x] **ä»»å‹™1.4**: é–‹ç™¼ç’°å¢ƒè¨­å®šæŒ‡å— âœ… **å·²å®Œæˆ**
- [x] **ä»»å‹™1.5**: Windows 10 ç’°å¢ƒåˆå§‹åŒ– âœ… **å·²å®Œæˆ** (2025-01-08)
  - âœ… Python 3.13.5 è™›æ“¬ç’°å¢ƒå»ºç«‹å®Œæˆ
  - âœ… PowerShell åŸ·è¡Œæ”¿ç­–é…ç½®å®Œæˆ
  - âœ… æ‰€æœ‰ä¾è³´å¥—ä»¶å®‰è£æˆåŠŸ
  - âœ… README.md Windows è¨­å®šæŒ‡å—æ›´æ–°

### ç¬¬äºŒéšæ®µï¼šæ ¸å¿ƒæ¨¡çµ„é–‹ç™¼
- [x] **ä»»å‹™2.1**: IPæª¢æ¸¬æ¨¡çµ„é–‹ç™¼ âš ï¸ **éœ€è¦æ›´æ–°**
  - âœ… æœ¬åœ°IPæª¢æ¸¬åŠŸèƒ½ (MacOSæ¸¬è©¦é€šé)
  - âœ… å…¬å…±IPæª¢æ¸¬åŠŸèƒ½ (å¤šæœå‹™å‚™æ´)
  - ğŸ”„ **éœ€è¦é‡æ–°å¯¦ç¾**: æ™ºèƒ½IPè®ŠåŒ–æª¢æ¸¬æ©Ÿåˆ¶
  - ğŸ”„ **éœ€è¦é‡æ–°å¯¦ç¾**: èˆ‡æ­·å²ç®¡ç†æ¨¡çµ„æ•´åˆ
  - âœ… è·¨å¹³å°ç›¸å®¹æ€§ (MacOSé©—è­‰)
  - ğŸ”„ **éœ€è¦æ›´æ–°**: æ¸¬è©¦ä»¥æ”¯æ´æ–°çš„è®ŠåŒ–æª¢æ¸¬é‚è¼¯
- [x] **ä»»å‹™2.2**: Discordé€šä¿¡æ¨¡çµ„é–‹ç™¼ âœ… **å·²å®Œæˆ**
  - âœ… Discord Webhook API é€šä¿¡åŠŸèƒ½ (MacOSæ¸¬è©¦é€šé)
  - âœ… å„ªåŒ–è¨Šæ¯æ ¼å¼åŒ– ("Minecraft Server IP Updated: {ip}:25565")
  - âœ… å®Œæ•´éŒ¯èª¤è™•ç†èˆ‡é‡è©¦æ©Ÿåˆ¶
  - âœ… è·¨å¹³å°ç›¸å®¹æ€§ (MacOSé©—è­‰)
  - âœ… å®Œæ•´å–®å…ƒæ¸¬è©¦ (22/22 é€šé)
  - âœ… æ¨¡çµ„æ•´åˆæ¸¬è©¦ (èˆ‡IP detectoræ•´åˆ)
  - âœ… ç°¡åŒ–ç’°å¢ƒè®Šæ•¸è¨­å®š (åªéœ€DISCORD_WEBHOOK_URL)
- [ ] **ä»»å‹™2.3**: IPæ­·å²ç®¡ç†æ¨¡çµ„é–‹ç™¼ ğŸ†• **æ–°å¢**
  - ğŸ“ IPæ­·å²è¨˜éŒ„æª”æ¡ˆæ ¼å¼è¨­è¨ˆ
  - ğŸ’¾ æŒä¹…åŒ–å­˜å„²å¯¦ç¾
  - ğŸ” IPè®ŠåŒ–æª¢æ¸¬é‚è¼¯
  - ğŸ“Š æ­·å²çµ±è¨ˆèˆ‡åˆ†æåŠŸèƒ½
  - ğŸ§¹ è‡ªå‹•æ¸…ç†èˆ‡å‚™ä»½æ©Ÿåˆ¶
  - ğŸ”’ æª”æ¡ˆè®€å¯«å®‰å…¨æ€§è™•ç†
  - âœ… å®Œæ•´å–®å…ƒæ¸¬è©¦
- [ ] **ä»»å‹™2.4**: è¨­å®šç®¡ç†æ¨¡çµ„é–‹ç™¼ âš ï¸ **éœ€è¦æ›´æ–°**
  - ğŸ”„ åŠ å…¥IPæ­·å²é…ç½®æ”¯æ´
- [ ] **ä»»å‹™2.5**: æ—¥èªŒç³»çµ±æ¨¡çµ„é–‹ç™¼

### ç¬¬ä¸‰éšæ®µï¼šæ’ç¨‹èˆ‡æ•´åˆ
- [ ] **ä»»å‹™3.1**: æ’ç¨‹ç³»çµ±å¯¦ç¾ âš ï¸ **éœ€è¦æ›´æ–°**
  - ğŸ”„ **æ™ºèƒ½æ’ç¨‹é‚è¼¯**: åªæœ‰IPè®ŠåŒ–æ™‚æ‰ç™¼é€Discordé€šçŸ¥
  - ğŸ”„ **æ‰‹å‹•åŸ·è¡Œæ¨¡å¼**: å¼·åˆ¶ç™¼é€é€šçŸ¥ä¸¦æ›´æ–°æ­·å²è¨˜éŒ„
  - ğŸ”„ **æ¸¬è©¦æ¨¡å¼**: æ¨¡æ“¬æª¢æ¸¬ä½†ä¸å½±éŸ¿æ­·å²è¨˜éŒ„
- [ ] **ä»»å‹™3.2**: ä¸»ç¨‹å¼é‚è¼¯æ•´åˆ âš ï¸ **éœ€è¦æ›´æ–°**
  - ğŸ”„ æ•´åˆIPæ­·å²ç®¡ç†æ¨¡çµ„
  - ğŸ”„ å¯¦ç¾ä¸åŒåŸ·è¡Œæ¨¡å¼çš„é‚è¼¯åˆ†æ”¯
- [ ] **ä»»å‹™3.3**: éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- [ ] **ä»»å‹™3.4**: å–®å…ƒæ¸¬è©¦æ’°å¯« âš ï¸ **éœ€è¦æ›´æ–°**
  - ğŸ”„ æ–°å¢IPè®ŠåŒ–æª¢æ¸¬æ¸¬è©¦
  - ğŸ”„ æ–°å¢æ­·å²è¨˜éŒ„ç®¡ç†æ¸¬è©¦
  - ğŸ”„ æ–°å¢æ•´åˆæµç¨‹æ¸¬è©¦

### ç¬¬å››éšæ®µï¼šéƒ¨ç½²èˆ‡æ–‡ä»¶
- [ ] **ä»»å‹™4.1**: éƒ¨ç½²è…³æœ¬é–‹ç™¼
- [ ] **ä»»å‹™4.2**: ä½¿ç”¨è€…æ–‡ä»¶æ’°å¯«
- [ ] **ä»»å‹™4.3**: è·¨å¹³å°æ¸¬è©¦
- [ ] **ä»»å‹™4.4**: æ•ˆèƒ½å„ªåŒ–

## ğŸ—ï¸ å°ˆæ¡ˆæ¶æ§‹è¨­è¨ˆ

### ç›®éŒ„çµæ§‹
```
discord-IP-bot/
â”œâ”€â”€ src/                    # ä¸»è¦ç¨‹å¼ç¢¼ç›®éŒ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ip_detector.py      # IPæª¢æ¸¬æ¨¡çµ„
â”‚   â”œâ”€â”€ ip_history.py       # IPæ­·å²è¨˜éŒ„ç®¡ç†æ¨¡çµ„
â”‚   â”œâ”€â”€ discord_client.py   # Discordé€šä¿¡æ¨¡çµ„
â”‚   â”œâ”€â”€ scheduler.py        # æ’ç¨‹ç®¡ç†æ¨¡çµ„
â”‚   â”œâ”€â”€ config.py          # è¨­å®šç®¡ç†æ¨¡çµ„
â”‚   â””â”€â”€ logger.py          # æ—¥èªŒç³»çµ±æ¨¡çµ„
â”œâ”€â”€ main.py                # ä¸»ç¨‹å¼é€²å…¥é»
â”œâ”€â”€ requirements.txt       # Pythonä¾è³´å¥—ä»¶
â”œâ”€â”€ setup.py              # å®‰è£è…³æœ¬
â”œâ”€â”€ .env.example          # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ .env                  # å¯¦éš›ç’°å¢ƒè®Šæ•¸ï¼ˆgit ignoreï¼‰
â”œâ”€â”€ config/               # è¨­å®šæª”ç›®éŒ„
â”‚   â”œâ”€â”€ default.json      # é è¨­è¨­å®šæª”
â”‚   â””â”€â”€ ip_history.json   # IPæ­·å²è¨˜éŒ„æª”æ¡ˆ
â”œâ”€â”€ logs/                 # æ—¥èªŒæª”ç›®éŒ„
â”œâ”€â”€ scripts/              # éƒ¨ç½²èˆ‡ç¶­è­·è…³æœ¬
â”‚   â”œâ”€â”€ install.sh        # Linux/Macå®‰è£è…³æœ¬
â”‚   â”œâ”€â”€ install.bat       # Windowså®‰è£è…³æœ¬
â”‚   â””â”€â”€ setup_cron.sh     # æ’ç¨‹è¨­å®šè…³æœ¬
â”œâ”€â”€ tests/                # æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ test_ip_detector.py
â”‚   â”œâ”€â”€ test_discord_client.py
â”‚   â””â”€â”€ test_config.py
â”œâ”€â”€ docs/                 # æ–‡ä»¶ç›®éŒ„
â”‚   â”œâ”€â”€ setup_guide.md    # è¨­å®šæŒ‡å—
â”‚   â””â”€â”€ troubleshooting.md # æ•…éšœæ’é™¤
â”œâ”€â”€ README.md             # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
â”œâ”€â”€ spec.md              # æœ¬è¦æ ¼æ–‡ä»¶
â””â”€â”€ .gitignore           # Gitå¿½ç•¥æª”æ¡ˆæ¸…å–®
```

### ç³»çµ±æ¶æ§‹åœ–
```mermaid
graph TB
    A[ä¸»ç¨‹å¼ main.py] --> B[æ’ç¨‹ç³»çµ± scheduler.py]
    A --> C[è¨­å®šç®¡ç† config.py]
    A --> D[æ—¥èªŒç³»çµ± logger.py]
    
    B --> E[IPæª¢æ¸¬æ¨¡çµ„ ip_detector.py]
    E --> F[æœ¬åœ°IPæª¢æ¸¬]
    E --> G[å¤–ç¶²IPæª¢æ¸¬]
    E --> N[IPæ­·å²ç®¡ç† ip_history.py]
    
    B --> H[Discordé€šä¿¡æ¨¡çµ„ discord_client.py]
    H --> I[è¨Šæ¯æ ¼å¼åŒ–]
    H --> J[APIé€šä¿¡]
    
    C --> K[ç’°å¢ƒè®Šæ•¸ .env]
    C --> L[è¨­å®šæª” config/default.json]
    
    D --> M[æ—¥èªŒæª”æ¡ˆ logs/]
    
    N --> O[IPæ­·å²è¨˜éŒ„ config/ip_history.json]
    N --> P[è®ŠåŒ–æª¢æ¸¬é‚è¼¯]
    N --> Q[æ­·å²çµ±è¨ˆåˆ†æ]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style E fill:#e8f5e8
    style H fill:#fff3e0
    style N fill:#f1f8e9
```

### è³‡æ–™æµç¨‹åœ–

#### æ’ç¨‹æ¨¡å¼ï¼ˆæ™ºèƒ½è®ŠåŒ–æª¢æ¸¬ï¼‰
```mermaid
sequenceDiagram
    participant S as ç³»çµ±æ’ç¨‹å™¨
    participant M as ä¸»ç¨‹å¼
    participant IP as IPæª¢æ¸¬æ¨¡çµ„
    participant H as IPæ­·å²ç®¡ç†
    participant DC as Discordå®¢æˆ¶ç«¯
    participant D as Discordä¼ºæœå™¨
    participant L as æ—¥èªŒç³»çµ±

    S->>M: è§¸ç™¼æ¯æ—¥åŸ·è¡Œ
    M->>L: è¨˜éŒ„å•Ÿå‹•æ—¥èªŒ
    M->>IP: è«‹æ±‚IPæª¢æ¸¬
    IP->>IP: æª¢æ¸¬æœ¬åœ°IP
    IP->>IP: æª¢æ¸¬å¤–ç¶²IP
    IP->>H: è®€å–ä¸Šæ¬¡è¨˜éŒ„çš„IP
    H-->>IP: è¿”å›æ­·å²IPè³‡æ–™
    IP->>IP: æ¯”è¼ƒIPæ˜¯å¦è®ŠåŒ–
    
    alt IPæœ‰è®ŠåŒ–
        IP-->>M: è¿”å›IPè³‡è¨Š + è®ŠåŒ–æ¨™è¨˜
        M->>DC: å‚³é€IPè³‡æ–™
        DC->>DC: æ ¼å¼åŒ–è¨Šæ¯
        DC->>D: ç™¼é€åˆ°Discordé »é“
        D-->>DC: ç¢ºèªè¨Šæ¯é€é”
        DC-->>M: è¿”å›åŸ·è¡Œçµæœ
        M->>H: æ›´æ–°IPæ­·å²è¨˜éŒ„
        M->>L: è¨˜éŒ„ç™¼é€æˆåŠŸ
    else IPç„¡è®ŠåŒ–
        IP-->>M: è¿”å›IPè³‡è¨Š + ç„¡è®ŠåŒ–æ¨™è¨˜
        M->>H: è¨˜éŒ„æª¢æ¸¬äº‹ä»¶ï¼ˆä¸æ›´æ–°IPï¼‰
        M->>L: è¨˜éŒ„è·³éç™¼é€
    end
    
    M->>S: å®ŒæˆåŸ·è¡Œ
```

#### æ‰‹å‹•æ¨¡å¼ï¼ˆå¼·åˆ¶ç™¼é€ï¼‰
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ¶
    participant M as ä¸»ç¨‹å¼
    participant IP as IPæª¢æ¸¬æ¨¡çµ„
    participant H as IPæ­·å²ç®¡ç†
    participant DC as Discordå®¢æˆ¶ç«¯
    participant D as Discordä¼ºæœå™¨
    participant L as æ—¥èªŒç³»çµ±

    U->>M: æ‰‹å‹•åŸ·è¡Œå‘½ä»¤
    M->>L: è¨˜éŒ„æ‰‹å‹•åŸ·è¡Œ
    M->>IP: è«‹æ±‚IPæª¢æ¸¬
    IP->>IP: æª¢æ¸¬æœ¬åœ°IP
    IP->>IP: æª¢æ¸¬å¤–ç¶²IP
    IP-->>M: è¿”å›IPè³‡è¨Šï¼ˆå¼·åˆ¶ç™¼é€ï¼‰
    M->>DC: å‚³é€IPè³‡æ–™
    DC->>DC: æ ¼å¼åŒ–è¨Šæ¯
    DC->>D: ç™¼é€åˆ°Discordé »é“
    D-->>DC: ç¢ºèªè¨Šæ¯é€é”
    DC-->>M: è¿”å›åŸ·è¡Œçµæœ
    M->>H: æ›´æ–°IPæ­·å²è¨˜éŒ„
    M->>L: è¨˜éŒ„æ‰‹å‹•åŸ·è¡Œå®Œæˆ
    M-->>U: è¿”å›åŸ·è¡Œçµæœ
```

## ğŸ”§ æŠ€è¡“å¯¦ç¾æ–¹æ¡ˆ

### ç¨‹å¼èªè¨€èˆ‡æ¡†æ¶é¸æ“‡
- **ä¸»è¦èªè¨€**: Python 3.10 (åœ¨ venv è™›æ“¬ç’°å¢ƒå…§åŸ·è¡Œ)
- **Discordåº«**: discord.py æˆ– requests (Webhookæ–¹å¼)
- **æ’ç¨‹åº«**: schedule æˆ– APScheduler
- **è¨­å®šç®¡ç†**: python-dotenv, configparser
- **æ—¥èªŒç³»çµ±**: logging (å…§å»ºæ¨¡çµ„)
- **ç¶²è·¯è«‹æ±‚**: requests, urllib3
- **é‡è¦**: æ‰€æœ‰æ¨¡çµ„å¿…é ˆè§£è€¦è¨­è¨ˆï¼Œç¢ºä¿å¯ç¨ç«‹æ¸¬è©¦ï¼Œä¸¦ä¿è­‰è·¨å¹³å°ç›¸å®¹æ€§ (MacOS, Windows 10/11)

### æ ¸å¿ƒæ¨¡çµ„è¨­è¨ˆ

#### 1. IPæª¢æ¸¬æ¨¡çµ„ (ip_detector.py)
```python
class IPDetector:
    """IPåœ°å€æª¢æ¸¬é¡åˆ¥"""
    
    def __init__(self, config: dict = None, history_manager=None):
        """åˆå§‹åŒ–IPæª¢æ¸¬å™¨"""
        pass
    
    def get_local_ip(self) -> str:
        """ç²å–æœ¬åœ°å…§ç¶²IPåœ°å€"""
        pass
    
    def get_public_ip(self) -> str:
        """ç²å–å¤–ç¶²IPåœ°å€"""
        pass
    
    def get_all_ips(self) -> dict:
        """ç²å–æ‰€æœ‰IPè³‡è¨Š"""
        pass
    
    def check_ip_with_history(self, mode: str = "scheduled") -> dict:
        """æª¢æ¸¬IPä¸¦èˆ‡æ­·å²è¨˜éŒ„æ¯”è¼ƒ
        
        Args:
            mode: åŸ·è¡Œæ¨¡å¼ ("scheduled", "manual", "test")
            
        Returns:
            dict: {
                "local_ip": str,
                "public_ip": str,
                "has_changed": bool,
                "should_notify": bool,
                "mode": str,
                "timestamp": str
            }
        """
        pass
    
    def compare_with_last(self, current_ips: dict) -> bool:
        """èˆ‡ä¸Šæ¬¡è¨˜éŒ„æ¯”è¼ƒæ˜¯å¦æœ‰è®ŠåŒ–"""
        pass
```

#### 2. IPæ­·å²ç®¡ç†æ¨¡çµ„ (ip_history.py)
```python
class IPHistoryManager:
    """IPæ­·å²è¨˜éŒ„ç®¡ç†å™¨"""
    
    def __init__(self, history_file: str = "config/ip_history.json"):
        """åˆå§‹åŒ–æ­·å²ç®¡ç†å™¨"""
        pass
    
    def load_history(self) -> dict:
        """è¼‰å…¥IPæ­·å²è¨˜éŒ„"""
        pass
    
    def save_history(self, history_data: dict) -> bool:
        """ä¿å­˜IPæ­·å²è¨˜éŒ„"""
        pass
    
    def get_last_public_ip(self) -> str | None:
        """ç²å–ä¸Šæ¬¡è¨˜éŒ„çš„å…¬å…±IP"""
        pass
    
    def has_ip_changed(self, current_public_ip: str) -> bool:
        """æª¢æŸ¥å…¬å…±IPæ˜¯å¦æœ‰è®ŠåŒ–"""
        pass
    
    def record_ip_check(self, ip_data: dict, mode: str, notification_sent: bool) -> bool:
        """è¨˜éŒ„ä¸€æ¬¡IPæª¢æ¸¬äº‹ä»¶
        
        Args:
            ip_data: IPæª¢æ¸¬çµæœ
            mode: åŸ·è¡Œæ¨¡å¼
            notification_sent: æ˜¯å¦ç™¼é€äº†é€šçŸ¥
        """
        pass
    
    def get_history_stats(self) -> dict:
        """ç²å–æ­·å²çµ±è¨ˆè³‡è¨Š"""
        pass
    
    def cleanup_old_records(self, keep_days: int = 30) -> int:
        """æ¸…ç†èˆŠè¨˜éŒ„ï¼Œè¿”å›æ¸…ç†çš„è¨˜éŒ„æ•¸"""
        pass
```

#### æ­·å²è¨˜éŒ„æª”æ¡ˆæ ¼å¼ (config/ip_history.json)
```json
{
  "metadata": {
    "created_at": "2025-01-04T20:21:04+08:00",
    "last_updated": "2025-01-04T20:21:04+08:00",
    "version": "1.0",
    "total_checks": 42
  },
  "current": {
    "public_ip": "36.230.8.13",
    "local_ip": "192.168.1.100",
    "last_updated": "2025-01-04T20:21:04+08:00",
    "last_notification_sent": "2025-01-04T09:00:15+08:00"
  },
  "statistics": {
    "total_ip_changes": 5,
    "total_notifications_sent": 12,
    "last_change_date": "2025-01-04T09:00:15+08:00",
    "check_frequency": {
      "scheduled": 35,
      "manual": 7,
      "test": 15
    }
  },
  "history": [
    {
      "timestamp": "2025-01-04T20:21:04+08:00",
      "public_ip": "36.230.8.13",
      "local_ip": "192.168.1.100",
      "mode": "scheduled",
      "ip_changed": false,
      "notification_sent": false,
      "execution_duration": 2.34
    },
    {
      "timestamp": "2025-01-04T09:00:15+08:00",
      "public_ip": "36.230.8.13",
      "local_ip": "192.168.1.100",
      "mode": "scheduled",
      "ip_changed": true,
      "notification_sent": true,
      "execution_duration": 3.12,
      "previous_public_ip": "203.0.113.1"
    }
  ]
}
```

#### 3. Discordé€šä¿¡æ¨¡çµ„ (discord_client.py)
```python
class DiscordClient:
    """Discord Webhook é€šä¿¡å®¢æˆ¶ç«¯"""
    
    def __init__(self, webhook_url: str, config: dict = None):
        """åˆå§‹åŒ–Discord Webhookå®¢æˆ¶ç«¯ (åªéœ€è¦Webhook URL)"""
        pass
    
    def send_ip_notification(self, ip_address: str) -> bool:
        """ç™¼é€Minecraftä¼ºæœå™¨IPé€šçŸ¥"""
        pass
    
    def send_minecraft_server_notification(self, ip_data: dict) -> bool:
        """ç™¼é€Minecraftä¼ºæœå™¨é€šçŸ¥ (åªä½¿ç”¨å…¬å…±IP)"""
        pass
    
    def test_connection(self) -> bool:
        """æ¸¬è©¦Discordé€£ç·šç‹€æ…‹"""
        pass
```

#### 4. è¨­å®šç®¡ç†æ¨¡çµ„ (config.py)
```python
class ConfigManager:
    """è¨­å®šæª”ç®¡ç†å™¨"""
    
    def load_config(self) -> dict:
        """è¼‰å…¥è¨­å®šæª”"""
        pass
    
    def validate_config(self, config: dict) -> bool:
        """é©—è­‰è¨­å®šæª”å®Œæ•´æ€§"""
        pass
    
    def get_discord_config(self) -> dict:
        """ç²å–Discordç›¸é—œè¨­å®š"""
        pass
    
    def get_schedule_config(self) -> dict:
        """ç²å–æ’ç¨‹ç›¸é—œè¨­å®š"""
        pass
    
    def get_ip_history_config(self) -> dict:
        """ç²å–IPæ­·å²è¨˜éŒ„ç›¸é—œè¨­å®š"""
        pass
    
    def get_history_file_path(self) -> str:
        """ç²å–IPæ­·å²è¨˜éŒ„æª”æ¡ˆè·¯å¾‘"""
        pass
```

### è¨­å®šæª”æ ¼å¼

#### ç’°å¢ƒè®Šæ•¸ (.env)
```env
# Discord Webhook è¨­å®š (å”¯ä¸€éœ€è¦çš„Discordé…ç½®)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN

# æ‡‰ç”¨ç¨‹å¼è¨­å®š
APP_NAME=Discord IP Bot
LOG_LEVEL=INFO
SCHEDULE_TIME=08:00

# IPæª¢æ¸¬è¨­å®š
CHECK_PUBLIC_IP=true
CHECK_LOCAL_IP=true
IP_CHECK_TIMEOUT=10

# IPæ­·å²è¨˜éŒ„è¨­å®š
IP_HISTORY_FILE=config/ip_history.json
IP_HISTORY_KEEP_DAYS=30
IP_HISTORY_MAX_RECORDS=1000
```

#### è¨­å®šæª” (config/default.json)
```json
{
  "app": {
    "name": "Discord IP Bot",
    "version": "1.0.0",
    "timezone": "Asia/Taipei"
  },
  "discord": {
    "message_template": "ğŸŒ **IPåœ°å€é€šçŸ¥** ğŸŒ\nğŸ“… æ™‚é–“: {timestamp}\nğŸ  æœ¬åœ°IP: {local_ip}\nğŸŒ å¤–ç¶²IP: {public_ip}\nğŸ“Š ç‹€æ…‹: {status}",
    "retry_attempts": 3,
    "retry_delay": 5
  },
  "ip_detection": {
    "public_ip_services": [
      "https://ipify.org",
      "https://icanhazip.com",
      "https://ident.me"
    ],
    "timeout": 10,
    "retry_attempts": 3
  },
  "logging": {
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    "max_file_size": "10MB",
    "backup_count": 5
  },
  "ip_history": {
    "file_path": "config/ip_history.json",
    "keep_days": 30,
    "max_records": 1000,
    "auto_cleanup": true,
    "backup_on_corruption": true,
    "compression": false
  }
}
```

## ğŸ”’ å®‰å…¨æ€§è€ƒé‡

### æ•æ„Ÿè³‡è¨Šä¿è­·
1. **Discord Tokenå®‰å…¨**
   - ä½¿ç”¨ç’°å¢ƒè®Šæ•¸å„²å­˜
   - çµ•ä¸ç¡¬ç·¨ç¢¼æ–¼ç¨‹å¼ä¸­
   - åŠ å…¥.gitignoreé˜²æ­¢æ„å¤–æäº¤

2. **IPè³‡è¨Šéš±ç§**
   - æä¾›IPéƒ¨åˆ†é®è”½é¸é …
   - è¨˜éŒ„æ—¥èªŒæ™‚é®è”½æ•æ„Ÿéƒ¨åˆ†
   - æ”¯æ´åƒ…é€šçŸ¥IPè®ŠåŒ–è€Œéå®Œæ•´IP

3. **æ¬Šé™æ§åˆ¶**
   - Discordæ©Ÿå™¨äººæœ€å°æ¬Šé™åŸå‰‡
   - åƒ…æˆäºˆå¿…è¦çš„è¨Šæ¯ç™¼é€æ¬Šé™
   - å®šæœŸæª¢æŸ¥æ©Ÿå™¨äººæ¬Šé™ç‹€æ…‹

### éŒ¯èª¤è™•ç†ç­–ç•¥
```python
# ç¶²è·¯éŒ¯èª¤è™•ç†ç¯„ä¾‹
try:
    ip_data = ip_detector.get_all_ips()
    discord_client.send_message(ip_data)
except NetworkError as e:
    logger.error(f"ç¶²è·¯é€£ç·šå¤±æ•—: {e}")
    # å¯¦æ–½é‡è©¦æ©Ÿåˆ¶
except DiscordAPIError as e:
    logger.error(f"Discord APIéŒ¯èª¤: {e}")
    # è¨˜éŒ„éŒ¯èª¤ï¼Œç¨å¾Œé‡è©¦
except Exception as e:
    logger.critical(f"æœªé æœŸéŒ¯èª¤: {e}")
    # ç™¼é€ç·Šæ€¥é€šçŸ¥
```

## ğŸ“¦ éƒ¨ç½²èˆ‡ç¶­è­·

### å®‰è£éœ€æ±‚
- Python 3.10
- Python venv è™›æ“¬ç’°å¢ƒ  
- ç¶²è·¯é€£ç·š
- Discord Webhook URL (å¾Discordä¼ºæœå™¨è¨­å®šä¸­å–å¾—)

### å®‰è£æ­¥é©Ÿ
1. **è¤‡è£½å°ˆæ¡ˆ**
   ```bash
   git clone https://github.com/username/discord-IP-bot.git
   cd discord-IP-bot
   ```

2. **å®‰è£ä¾è³´**
   ```bash
   pip install -r requirements.txt
   ```

3. **è¨­å®šç’°å¢ƒè®Šæ•¸**
   ```bash
   cp .env.example .env
   # ç·¨è¼¯.envæª”æ¡ˆï¼Œå¡«å…¥Discord Webhook URL
   ```

4. **æ¸¬è©¦åŸ·è¡Œ**
   ```bash
   python main.py --test
   ```

5. **è¨­å®šæ’ç¨‹**
   - Linux/Mac: ä½¿ç”¨cron
   - Windows: ä½¿ç”¨å·¥ä½œæ’ç¨‹å™¨

### æ’ç¨‹è¨­å®šç¯„ä¾‹

#### Linux/Mac (cron)
```bash
# æ¯å¤©æ—©ä¸Š8é»åŸ·è¡Œ
0 8 * * * /usr/bin/python3 /path/to/discord-IP-bot/main.py
```

#### Windows (Task Scheduler)
```powershell
# ä½¿ç”¨PowerShellå»ºç«‹æ’ç¨‹å·¥ä½œ
$action = New-ScheduledTaskAction -Execute "python" -Argument "C:\path\to\discord-IP-bot\main.py"
$trigger = New-ScheduledTaskTrigger -Daily -At "08:00"
Register-ScheduledTask -TaskName "Discord IP Bot" -Action $action -Trigger $trigger
```

### ç›£æ§èˆ‡ç¶­è­·
- å®šæœŸæª¢æŸ¥æ—¥èªŒæª”æ¡ˆ
- ç›£æ§Discordæ©Ÿå™¨äººç‹€æ…‹
- å®šæœŸæ›´æ–°ä¾è³´å¥—ä»¶
- å‚™ä»½è¨­å®šæª”æ¡ˆ

## ğŸ“Š æ•ˆèƒ½èˆ‡å¯é æ€§

### æ•ˆèƒ½æŒ‡æ¨™
- åŸ·è¡Œæ™‚é–“: < 30ç§’
- è¨˜æ†¶é«”ä½¿ç”¨: < 100MB
- ç¶²è·¯è«‹æ±‚: < 5å€‹APIå‘¼å«
- æª”æ¡ˆå¤§å°: æ•´å€‹å°ˆæ¡ˆ < 50MB

### å¯é æ€§è¨­è¨ˆ
- é‡è©¦æ©Ÿåˆ¶: ç¶²è·¯å¤±æ•—è‡ªå‹•é‡è©¦3æ¬¡
- é€¾æ™‚è™•ç†: æ‰€æœ‰ç¶²è·¯è«‹æ±‚10ç§’é€¾æ™‚
- ç•°å¸¸æ¢å¾©: ç¨‹å¼ç•°å¸¸è‡ªå‹•è¨˜éŒ„ä¸¦å„ªé›…é€€å‡º
- è³‡æ–™å‚™ä»½: IPè®ŠåŒ–æ­·å²è¨˜éŒ„å„²å­˜

## ğŸ”® æœªä¾†æ“´å±•è¨ˆç•«

### ç¬¬äºŒç‰ˆåŠŸèƒ½
- [ ] Webç®¡ç†ä»‹é¢
- [ ] å¤šDiscordä¼ºæœå™¨æ”¯æ´
- [ ] IPåœ°ç†ä½ç½®è³‡è¨Š
- [ ] æ­·å²è³‡æ–™åœ–è¡¨
- [ ] ç§»å‹•æ‡‰ç”¨ç¨‹å¼é€šçŸ¥

### ç¬¬ä¸‰ç‰ˆåŠŸèƒ½
- [ ] å®¹å™¨åŒ–éƒ¨ç½² (Docker)
- [ ] é›²ç«¯æœå‹™æ•´åˆ
- [ ] é€²éšåˆ†æåŠŸèƒ½
- [ ] APIé–‹æ”¾å¹³å°

## ğŸ“ˆ é–‹ç™¼æ™‚ç¨‹

| éšæ®µ | æ™‚é–“ä¼°è¨ˆ | ä¸»è¦ä»»å‹™ |
|------|----------|----------|
| ç¬¬ä¸€éšæ®µ | 0.5å¤© | å°ˆæ¡ˆå»ºè¨­ã€ç’°å¢ƒè¨­å®š |
| ç¬¬äºŒéšæ®µ | 1.5å¤© | æ ¸å¿ƒæ¨¡çµ„é–‹ç™¼ |
| ç¬¬ä¸‰éšæ®µ | 1å¤© | æ•´åˆèˆ‡æ¸¬è©¦ |
| ç¬¬å››éšæ®µ | 1å¤© | éƒ¨ç½²èˆ‡æ–‡ä»¶ |
| **ç¸½è¨ˆ** | **4å¤©** | **å®Œæ•´å°ˆæ¡ˆäº¤ä»˜** |

## ğŸ“ é©—æ”¶æ¨™æº–

### åŠŸèƒ½é©—æ”¶
- âœ… èƒ½æˆåŠŸæª¢æ¸¬æœ¬åœ°IPå’Œå¤–ç¶²IP
- âœ… èƒ½æ­£ç¢ºç™¼é€è¨Šæ¯åˆ°Discordé »é“
- âœ… æ’ç¨‹åŠŸèƒ½æ­£å¸¸é‹ä½œ
- âœ… éŒ¯èª¤è™•ç†æ©Ÿåˆ¶å®Œå–„
- âœ… æ—¥èªŒè¨˜éŒ„å®Œæ•´

### å“è³ªé©—æ”¶
- âœ… ç¨‹å¼ç¢¼éµå¾ªPEP 8è¦ç¯„
- âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†
- âœ… è©³ç´°çš„ç¨‹å¼ç¢¼è¨»é‡‹
- âœ… è·¨å¹³å°ç›¸å®¹æ€§
- âœ… å®‰å…¨æ€§æª¢æŸ¥é€šé

### æ–‡ä»¶é©—æ”¶
- âœ… å®Œæ•´çš„README.md
- âœ… è©³ç´°çš„è¨­å®šæŒ‡å—
- âœ… æ•…éšœæ’é™¤æ–‡ä»¶
- âœ… APIæ–‡ä»¶èªªæ˜

---

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœ‰ä»»ä½•æŠ€è¡“å•é¡Œæˆ–éœ€è¦å”åŠ©ï¼Œè«‹åƒè€ƒï¼š
- ğŸ“– [è¨­å®šæŒ‡å—](docs/setup_guide.md)
- ğŸ”§ [æ•…éšœæ’é™¤](docs/troubleshooting.md)
- ğŸ’¬ GitHub Issues

---

## ğŸ“‹ æ›´æ–°æ­·å²

### 2024-08-04

#### é…ç½®ç³»çµ±æ”¹é€²å’Œæ’ç¨‹æ™‚é–“èª¿æ•´
- **ä¿®æ”¹**: å®Œå–„é…ç½®ç³»çµ±å’Œæ–‡ä»¶èªªæ˜
  - å‰µå»º `.env.example` ç¯„ä¾‹é…ç½®æ–‡ä»¶
  - å‰µå»ºå¯¦éš›çš„ `.env` é…ç½®æ–‡ä»¶  
  - ä¿®æ”¹é è¨­æ’ç¨‹æ™‚é–“å¾ `09:00` æ”¹ç‚º `21:30`ï¼ˆæ¯å¤©æ™šä¸Š9:30åŸ·è¡Œï¼‰
  - å¤§å¹…æ›´æ–° README.md çš„é…ç½®ç³»çµ±èªªæ˜ï¼š
    - æ˜ç¢ºèªªæ˜é…ç½®å„ªå…ˆé †åºï¼ˆç’°å¢ƒè®Šæ•¸ > .envæ–‡ä»¶ > ç¨‹å¼é è¨­å€¼ï¼‰
    - æä¾›å®Œæ•´çš„é…ç½®æ­¥é©Ÿèªªæ˜
    - æ·»åŠ é…ç½®é©—è­‰æ–¹æ³•
    - æ·»åŠ å„ç¨®é…ç½®é¸é …çš„è©³ç´°èªªæ˜
  - ä¿®æ­£ `src/config.py` ä¸­çš„é è¨­æ’ç¨‹æ™‚é–“è¨­å®š

#### .gitignore æ–‡ä»¶æ›´æ–°  
- **ä¿®æ”¹**: æ›´æ–° .gitignore æ–‡ä»¶
  - æ·»åŠ  `config/ip_history.json` å¿½ç•¥è¦å‰‡
  - æ·»åŠ  `ip_history_export_*.json` å¿½ç•¥è¦å‰‡  
  - æ·»åŠ  `data/*.json` å¿½ç•¥è¦å‰‡
  - ç¢ºä¿æ‰€æœ‰ IP æ­·å²å’Œæ•¸æ“šæ–‡ä»¶ä¸è¢« git è¿½è¹¤

---

**æ–‡ä»¶ç‰ˆæœ¬**: v1.2  
**æœ€å¾Œæ›´æ–°**: 2024å¹´8æœˆ4æ—¥  
**æ–‡ä»¶ç‹€æ…‹**: âœ… å·²å®Œæˆ